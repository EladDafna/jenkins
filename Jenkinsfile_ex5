/*
### Exercise 5: Using Environment Variables
**Objective**: Incorporate environment variables to configure aspects of the Jenkins pipeline dynamically.

**Tasks**:
1. Modify the existing Jenkinsfile to define and use environment variables within the pipeline.
2. Create stages that use these variables to perform different operations:
   - **Stage 1**: Define an environment variable to specify a directory name where files will be stored during the build.
   - **Stage 2**: Use a shell command to create the directory specified by the environment variable.
   - **Stage 3**: Create a simple text file in the directory, writing information about the build (e.g., build number, job name).
3. Ensure that the stages correctly utilize the environment variables and perform the actions based on the current build settings.
*/

pipeline {
    agent{
        label "linux"
    }
    environment {
        MY_DIR = "Build_Dir"
    }
    stages {
        stage("echo Varrible Dir , Create Directory - 1") {
            steps {
                script {
                    sh '''
                       echo "${env.MY_DIR}"
                       mkdir "${env.MY_DIR}"
                       cd "${env.MYDIR}"
                       pwd
                       ls -la
                       '''

                }
            }
        }
        stage ("Information about the build -2") {
            steps {
                script {
                    sh "echo 'Build Number is: ${BUILD_NUMBER}, \nJob Name is: ${JOB_NAME}' >> ${env.MY_DIR}/info.txt"

                }
            }

        }
        stage ("Check Files-3") {
            steps {
                sh "cat ${env.MY_DIR}/info.txt"

            }
         
        }
    }
    post{
        success {
            echo "The ${JOB_NAME} has Succsess"
        }
        failure {
            mail to: "eladdaf@gmail.com"
            subject: "Hello ${NODE_NAME}"
            body: "the ${JOB_NAME} has fail Please Check again the code."
        }
    }

}
